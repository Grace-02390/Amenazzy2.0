<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title> Amenazzy - Confirmar Pago</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="icon" type="image/x-icon" href="./imgs/favico.png">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #e0e0e0;
            color: #e0e0e0;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            position: relative;
            overflow-x: hidden;
            margin: 0;
        }

        @media (max-width: 768px) {
            nav {
                flex-direction: column;
                align-items: flex-start;
                padding: 1rem;
            }
            nav > div:first-child {
                margin-bottom: 0.5rem;
            }
            nav > div:last-child {
                flex-direction: column;
                align-items: flex-start;
                width: 100%;
                gap: 0.5rem;
            }
            nav a {
                width: 100%;
                text-align: center;
                padding: 0.5rem 0;
            }
            .payment-card {
                padding: 1.5rem;
            }
            .payment-card h2 {
                font-size: 2rem;
            }
        }
    </style>
</head>
<body class="flex flex-col min-h-screen">
    <header>
        <div class="w-full max-w-7xl mx-auto py-3">
            <div class="flex justify-between gap-8 items-center">
            <div>
                <a href="/bienvenida">
                <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTIiCmWsXvxJYw_vP5Pz_2-j3--o5CwaAZK7o7tMqxxmI1yG0chygARpu6w0BoisYWFNGw&usqp=CAU" 
                    alt="Amenazzy logo"
                    class="h-8 hover:opacity-90 transition duration-300" />
                </a>
            </div>
            
            <div class="flex items-center gap-8">
                <nav class="hidden lg:flex gap-8 text-black text-base">
                <a href="/bienvenida" class="hover:underline text-black">Inicio</a>
                <a href="/nosotros" class="hover:underline text-black">Nosotros</a>
                <a href="/productos" class="hover:underline text-black">Productos</a>
                </nav>

                <span class="hidden lg:block text-black">|</span>

                <div class="flex gap-4 items-center relative">
                <a href="/carrito" class="relative" title="Ver Carrito">
                    <i class="flex items-center justify-center bg-black text-white rounded-full w-[35px] h-[35px] bi bi-bag"></i>
                    <span th:if="${carritoCount > 0}"
                        th:text="${carritoCount}"
                        class="absolute -top-2 -right-2 bg-red-600 text-white text-xs font-bold w-5 h-5 flex items-center justify-center rounded-full">
                    </span>
                </a>
                <a href="/logout" title="Cerrar Sesi√≥n"
                    class="flex items-center justify-center w-[35px] h-[35px] bg-red-700 hover:bg-red-800 text-white rounded-full transition duration-200">
                    <i class="bi bi-box-arrow-right text-lg"></i>
                </a>
                </div>
            </div>
            </div>
        </div>
    </header>

    <main class="min-h-screen py-16 px-6">
        <div class="max-w-2xl mx-auto bg-white/90 border border-gray-300 rounded-3xl shadow-2xl p-10 space-y-8 animate-fade-in-up">

            <h2 class="text-4xl font-extrabold text-gray-800 text-center">Confirmar Pago</h2>

            <div th:if="${error}" class="bg-red-100 border border-red-400 text-red-700 px-5 py-3 rounded-xl text-base text-center" role="alert">
            <span th:text="${error}"></span>
            </div>

            <div class="space-y-4 text-base text-gray-700">
            <p><strong class="text-gray-800">Monto Total:</strong> <span class="text-blue-700 font-semibold" th:text="${'S/.' + #numbers.formatDecimal(totalPagar, 1, 2)}">S/.0.00</span></p>
            <p><strong class="text-gray-800">N√∫mero de Boleta:</strong> <span th:text="${numeroBoleta}"></span></p>
            </div>

            <form th:action="@{/pago/confirmar}" method="post" class="space-y-6">
            <input type="hidden" name="totalPagar" th:value="${totalPagar}" />
            <input type="hidden" name="numeroBoleta" th:value="${numeroBoleta}" />

            <div class="flex flex-col space-y-4 mb-6">
                <h3 class="text-gray-700 font-bold text-gl">M√©todo de Pago:</h3>
                <div class="flex items-center">
                    <input id="pagoEfectivo" type="radio" name="metodoPago" value="EFECTIVO"
                        class="focus:ring-red-600 rounded" onclick="toggleCardForm(false)">
                    <label for="pagoEfectivo" class="ml-2 text-gray-700">Efectivo</label>
                </div>
                <div class="flex items-center">
                    <input id="pagoTarjeta" type="radio" name="metodoPago" value="TARJETA"
                        class="focus:ring-red-600 rounded" onclick="toggleCardForm(true)">
                    <label for="pagoTarjeta" class="ml-2 text-gray-700">Tarjeta</label>
                </div>
            </div>
                <div id="cardDetails" class="space-y-4 mb-6 hidden">
                <input type="text" name="numeroTarjeta" placeholder="N√∫mero de Tarjeta"
                        class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring focus:border-blue-500 text-gray-700" required>

                <div class="flex gap-4">
                    <input type="text" name="fechaVencimiento" placeholder="MM/AA"
                        class="flex-1 border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring focus:border-blue-500 text-gray-700" required>
                    <input type="text" name="cvv" placeholder="CVV"
                        class="w-24 border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring focus:border-blue-500 text-gray-700" required>
                </div>
                </div>

            <button type="submit"
                    class="w-full bg-red-600 hover:bg-red-700 text-white font-semibold text-lg py-3 px-6 rounded-2xl shadow-xl transition duration-300 transform hover:scale-105 active:scale-95">
                <i class="fas fa-check-circle mr-2"></i> Confirmar y Realizar Pago
            </button>
            </form>

            <div class="text-center">
            <a href="/carrito"
                class="inline-block text-gray-700 hover:underline text-base font-medium transition transform hover:scale-105 active:scale-95">
                <i class="fas fa-arrow-left mr-1"></i> Volver al Carrito
            </a>
            </div>
        </div>
    </main>

    <div id="messageModal" class="fixed inset-0 bg-gray-800 bg-opacity-75 flex items-center justify-center z-50 hidden">
        <div class="bg-white p-6 rounded-lg shadow-lg text-center">
            <p id="messageText" class="text-lg font-semibold mb-4"></p>
            <button onclick="hideMessageModal()" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-lg">Cerrar</button>
        </div>
    </div>

    <footer class="bg-white border-t border-gray-200 text-gray-700 text-sm mt-16">
    <div class="max-w-7xl mx-auto px-6 py-10 grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-8">
        <div>
        <h5 class="text-base font-semibold text-gray-900 mb-3">Amenazzy</h5>
        <p class="text-sm leading-relaxed">Ropa de moda para toda la familia con estilo, comodidad y calidad.</p>
        </div>
        <div>
        <h5 class="text-base font-semibold text-gray-900 mb-3">Enlaces √∫tiles</h5>
        <ul class="space-y-2">
            <li><a href="/" class="hover:underline">Inicio</a></li>
            <li><a href="/productos-publicos" class="hover:underline">Productos</a></li>
            <li><a href="/login" class="hover:underline">Iniciar sesi√≥n</a></li>
            <li><a href="/registro" class="hover:underline">Registrarse</a></li>
        </ul>
        </div>
        <div>
        <h5 class="text-base font-semibold text-gray-900 mb-3">Cont√°ctanos</h5>
        <ul class="space-y-2">
            <li>üìç Av. Cutervo 123, Ica, Per√∫</li>
            <li>üìû +51 987 654 321</li>
            <li>‚úâÔ∏è soporte_ica@Amenazzy.com</li>
        </ul>
        </div>
        <div>
        <h5 class="text-base font-semibold text-gray-900 mb-3">S√≠guenos</h5>
        <div class="flex space-x-4">
            <a href="#" class="hover:text-blue-500"><i class="fab fa-facebook-f"></i></a>
            <a href="#" class="hover:text-pink-500"><i class="fab fa-instagram"></i></a>
            <a href="#" class="hover:text-blue-400"><i class="fab fa-twitter"></i></a>
        </div>
        </div>
    </div>

    <div class="text-center text-gray-500 text-xs py-4 border-t border-gray-200">
        ¬© 2025 Amenazzy. Todos los derechos reservados.
    </div>
    </footer>
</body>

<script>
    function showMessageModal(message, isSuccess = true) {
        const modal = document.getElementById('messageModal');
        const messageText = document.getElementById('messageText');
        messageText.innerText = message;
        messageText.classList.remove('text-green-700', 'text-red-700');
        messageText.classList.add(isSuccess ? 'text-green-700' : 'text-red-700');
        modal.classList.remove('hidden');
    }

    function hideMessageModal() {
        document.getElementById('messageModal').classList.add('hidden');
    }

    window.onclick = function(event) {
        const messageModal = document.getElementById('messageModal');
        if (event.target == messageModal) {
            messageModal.classList.add('hidden');
        }
    }

    window.onload = function() {
        const successMessage = "[[${success}]]";
        const errorMessage = "[[${error}]]";

        if (successMessage && successMessage !== '') {
            showMessageModal(successMessage, true);
        } else if (errorMessage && errorMessage !== '') {
            showMessageModal(errorMessage, false);
        }
    };
    function toggleCardForm(show) {
        const form = document.getElementById('cardDetails');
        const inputs = form.querySelectorAll('input');

        if (show) {
            form.classList.remove('hidden');
            inputs.forEach(input => input.setAttribute('required', 'required'));
        } else {
            form.classList.add('hidden');
            inputs.forEach(input => input.removeAttribute('required'));
        }
  } 
</script>
</body>
</html>